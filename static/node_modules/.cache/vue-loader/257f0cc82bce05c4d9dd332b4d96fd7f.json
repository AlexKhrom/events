{"remainingRequest":"/Users/mac/go/src/events/static/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mac/go/src/events/static/src/components/Code.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mac/go/src/events/static/src/components/Code.vue","mtime":1660313598771},{"path":"/Users/mac/go/src/events/static/node_modules/cache-loader/dist/cjs.js","mtime":1656160197065},{"path":"/Users/mac/go/src/events/static/node_modules/babel-loader/lib/index.js","mtime":1656160197672},{"path":"/Users/mac/go/src/events/static/node_modules/cache-loader/dist/cjs.js","mtime":1656160197065},{"path":"/Users/mac/go/src/events/static/node_modules/vue-loader/lib/index.js","mtime":1656160198005}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiY29kZSIsCiAgZGF0YTogKCkgPT4gKHsKICAgIHdhc1JlcTogZmFsc2UsCiAgICB2YWxpZDogdHJ1ZSwKICAgIHNob3c6IGZhbHNlLAogICAgcGFnZTogJycsCiAgICBjb2RlOiAnJywKICAgIGxvZ2luUnVsZXM6IFsKICAgICAgdiA9PiAhIXYgfHwgJ0xvZ2luIGlzIHJlcXVpcmVkJywKICAgICAgdiA9PiAodiAmJiB2Lmxlbmd0aCA8PSA2KSB8fCAnTG9naW4gbXVzdCBiZSBsZXNzIHRoYW4gNCBjaGFyYWN0ZXJzJywKICAgIF0sCiAgICBwYXNzd29yZDogJycsCiAgICBwYXNzd29yZFJ1bGVzOiBbCiAgICAgIHYgPT4gISF2IHx8ICdQYXNzd29yZCBpcyByZXF1aXJlZCcsCiAgICAgIHYgPT4gKHYgJiYgdi5sZW5ndGggPD0gMTApIHx8ICdQYXNzd29yZCBtdXN0IGJlIGxlc3MgdGhhbiAxMCBjaGFyYWN0ZXJzJywKICAgIF0sCiAgICBjb2RlUnVsZXM6IFsKICAgICAgdiA9PiAhIXYgfHwgJ2NvZGUgaXMgcmVxdWlyZWQnLAogICAgICB2ID0+ICh2ICYmIHYubGVuZ3RoID09PSA0KSB8fCAnY29kZSBtdXN0IGJlIDQgY2hhcmFjdGVycycsCiAgICBdLAogICAgZW1haWxSdWxlczogWwogICAgICB2ID0+ICEhdiB8fCAnRS1tYWlsIGlzIHJlcXVpcmVkJywKICAgICAgdiA9PiAvLitALitcLi4rLy50ZXN0KHYpIHx8ICdFLW1haWwgbXVzdCBiZSB2YWxpZCcsCiAgICBdLAoKICB9KSwKCiAgbWV0aG9kczogewogICAgY2hlY2tDb2RlKCkgewogICAgICBpZiAodGhpcy5jb2RlLmxlbmd0aCA9PT0gNCAmJiAhdGhpcy53YXNSZXEpIHsKICAgICAgICB0aGlzLmNoZWNrQ29kZVJlcSh7dG9rZW46IHRoaXMuZ2V0Q29va2llKCdjb2RlSWQnKSwgY29kZTogdGhpcy5jb2RlfSkKICAgICAgICB0aGlzLndhc1JlcSA9IHRydWUKICAgICAgICBjb25zb2xlLmxvZygnY29kZSA9IDQnKQogICAgICAgIC8vIHRoaXMucGFnZSA9ICdzaWduVXBJc09rJwogICAgICAgIC8vIHNldFRpbWVvdXQodGhpcy5jaGFuZ2VQYWdlKCdzaWduVXBJc09rJyksIDMwMDApCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy53YXNSZXEgPSBmYWxzZQogICAgICB9CiAgICB9LAogICAgc2lnblVwKCkgewogICAgICB0aGlzLiRyZWZzLmZvcm0udmFsaWRhdGUoKQogICAgICB0aGlzLnNpZ25VcFJlcSh7CiAgICAgICAgZW1haWw6IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXIuZW1haWwsCiAgICAgICAgbG9naW46IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXIubG9naW4sCiAgICAgICAgcGFzc3dvcmQ6IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXIucGFzc3dvcmQKICAgICAgfSkKICAgIH0sCiAgICBjaGFuZ2VQYWdlKCkgewogICAgICBjb25zb2xlLmxvZygicmVwbGFjZSEhIikKICAgICAgd2luZG93LmxvY2F0aW9uLnJlcGxhY2UoIi8iKQogICAgfSwKICAgIGFzeW5jIHNpZ25VcFJlcSh1c2VyKSB7CiAgICAgIGNvbnNvbGUubG9nKCdtYWtlIHJlcXVlc3QgOicsIHVzZXIpCiAgICAgIGxldCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCcvYXBpL3NpZ25VcCcsIHsKICAgICAgICBtZXRob2Q6ICdQT1NUJywKICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh1c2VyKQogICAgICB9KTsKCiAgICAgIGlmIChyZXNwb25zZS5vaykgeyAvLyDQtdGB0LvQuCBIVFRQLdGB0YLQsNGC0YPRgSDQsiDQtNC40LDQv9Cw0LfQvtC90LUgMjAwLTI5OQogICAgICAgIC8vINC/0L7Qu9GD0YfQsNC10Lwg0YLQtdC70L4g0L7RgtCy0LXRgtCwICjRgdC8LiDQv9GA0L4g0Y3RgtC+0YIg0LzQtdGC0L7QtCDQvdC40LbQtSkKICAgICAgICBjb25zb2xlLmxvZygicmVzcG9uc2UgPSAiLCByZXNwb25zZSkKICAgICAgICBjb25zb2xlLmxvZygib2tra2siKQogICAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUubG9nKCJub3Qgb2siKQogICAgICB9CiAgICB9LAogICAgYXN5bmMgY2hlY2tDb2RlUmVxKGNvZGVzKSB7CiAgICAgIGNvbnNvbGUubG9nKCdtYWtlIHJlcXVlc3QgOicsIGNvZGVzKQogICAgICBsZXQgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnL2FwaS9jaGVja0NvZGUnLCB7CiAgICAgICAgbWV0aG9kOiAnUE9TVCcsCiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoY29kZXMpCiAgICAgIH0pOwoKICAgICAgaWYgKHJlc3BvbnNlLm9rKSB7IC8vINC10YHQu9C4IEhUVFAt0YHRgtCw0YLRg9GBINCyINC00LjQsNC/0LDQt9C+0L3QtSAyMDAtMjk5CiAgICAgICAgLy8g0L/QvtC70YPRh9Cw0LXQvCDRgtC10LvQviDQvtGC0LLQtdGC0LAgKNGB0LwuINC/0YDQviDRjdGC0L7RgiDQvNC10YLQvtC0INC90LjQttC1KQogICAgICAgIGNvbnNvbGUubG9nKCJyZXNwb25zZSA9ICIsIHJlc3BvbnNlKQogICAgICAgIGNvbnNvbGUubG9nKCJva2trayIpCiAgICAgICAgdGhpcy5wYWdlID0gJ3NpZ25VcElzT2snCiAgICAgICAgY29uc29sZS5sb2coInRoaXMucGFnZSA9ICdzaWduVXBJc09rJyIpCiAgICAgICAgc2V0VGltZW91dCh0aGlzLmNoYW5nZVBhZ2UsIDE1MDApCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5wYWdlID0gJ3dyb25nJwogICAgICAgIGNvbnNvbGUubG9nKCJub3Qgb2siKQogICAgICB9CiAgICB9LAogICAgbWFyZ2luVG9wKCkgewogICAgICBjb25zdCBkZXZpY2VzID0gbmV3IFJlZ0V4cCgnQW5kcm9pZHx3ZWJPU3xpUGhvbmV8aVBhZHxpUG9kfEJsYWNrQmVycnl8QkJ8UGxheUJvb2t8SUVNb2JpbGV8V2luZG93cyBQaG9uZXxLaW5kbGV8U2lsa3xPcGVyYSBNaW5pJywgImkiKTsKICAgICAgaWYgKGRldmljZXMudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkgewogICAgICAgIHJldHVybiAnMTAwcHgnCiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuICc0MHB4JwogICAgICB9CiAgICB9LAogICAgZ2V0Q29va2llKG5hbWUpIHsKICAgICAgY29uc3QgdmFsdWUgPSBgOyAke2RvY3VtZW50LmNvb2tpZX1gOwogICAgICBjb25zdCBwYXJ0cyA9IHZhbHVlLnNwbGl0KGA7ICR7bmFtZX09YCk7CiAgICAgIGlmIChwYXJ0cy5sZW5ndGggPT09IDIpIHJldHVybiBwYXJ0cy5wb3AoKS5zcGxpdCgnOycpLnNoaWZ0KCk7CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["Code.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Code.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div>\n    <v-form\n        class=\"form\"\n        :style=\"'margin-top:'+marginTop()\"\n        ref=\"form\"\n        v-model=\"valid\"\n        lazy-validation\n    >\n      <h2 style=\"margin-bottom: 20px\">Check your email for code</h2>\n      <v-row style=\"margin-bottom: 0\">\n        <v-btn\n            @click=\"changePage('signUp')\"\n            color=\"grey\"\n            plain\n        >\n          change email\n        </v-btn>\n      </v-row>\n      <v-text-field\n          style=\"width: 150px\"\n          v-model=\"code\"\n          :rules=\"codeRules\"\n          v-mask=\"'####'\"\n          label=\"X-X-X-X\"\n          @input=\"checkCode\"\n          solo\n      ></v-text-field>\n      <v-btn\n          style=\"height: 40px;\"\n          color=\"primary\"\n          @click=\"signUp\"\n      >\n        reset code\n      </v-btn>\n    </v-form>\n    <v-form v-if=\"page==='signUpIsOk'\">\n      <div class=\"text-h2\" style=\"color: limegreen\">sign up is successful</div>\n    </v-form>\n    <v-form v-if=\"page==='wrong'\">\n      <div class=\"text-h2\" style=\"color: red\">bad code</div>\n    </v-form>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"code\",\n  data: () => ({\n    wasReq: false,\n    valid: true,\n    show: false,\n    page: '',\n    code: '',\n    loginRules: [\n      v => !!v || 'Login is required',\n      v => (v && v.length <= 6) || 'Login must be less than 4 characters',\n    ],\n    password: '',\n    passwordRules: [\n      v => !!v || 'Password is required',\n      v => (v && v.length <= 10) || 'Password must be less than 10 characters',\n    ],\n    codeRules: [\n      v => !!v || 'code is required',\n      v => (v && v.length === 4) || 'code must be 4 characters',\n    ],\n    emailRules: [\n      v => !!v || 'E-mail is required',\n      v => /.+@.+\\..+/.test(v) || 'E-mail must be valid',\n    ],\n\n  }),\n\n  methods: {\n    checkCode() {\n      if (this.code.length === 4 && !this.wasReq) {\n        this.checkCodeReq({token: this.getCookie('codeId'), code: this.code})\n        this.wasReq = true\n        console.log('code = 4')\n        // this.page = 'signUpIsOk'\n        // setTimeout(this.changePage('signUpIsOk'), 3000)\n      } else {\n        this.wasReq = false\n      }\n    },\n    signUp() {\n      this.$refs.form.validate()\n      this.signUpReq({\n        email: this.$store.state.user.email,\n        login: this.$store.state.user.login,\n        password: this.$store.state.user.password\n      })\n    },\n    changePage() {\n      console.log(\"replace!!\")\n      window.location.replace(\"/\")\n    },\n    async signUpReq(user) {\n      console.log('make request :', user)\n      let response = await fetch('/api/signUp', {\n        method: 'POST',\n        body: JSON.stringify(user)\n      });\n\n      if (response.ok) { // если HTTP-статус в диапазоне 200-299\n        // получаем тело ответа (см. про этот метод ниже)\n        console.log(\"response = \", response)\n        console.log(\"okkkk\")\n      } else {\n        console.log(\"not ok\")\n      }\n    },\n    async checkCodeReq(codes) {\n      console.log('make request :', codes)\n      let response = await fetch('/api/checkCode', {\n        method: 'POST',\n        body: JSON.stringify(codes)\n      });\n\n      if (response.ok) { // если HTTP-статус в диапазоне 200-299\n        // получаем тело ответа (см. про этот метод ниже)\n        console.log(\"response = \", response)\n        console.log(\"okkkk\")\n        this.page = 'signUpIsOk'\n        console.log(\"this.page = 'signUpIsOk'\")\n        setTimeout(this.changePage, 1500)\n      } else {\n        this.page = 'wrong'\n        console.log(\"not ok\")\n      }\n    },\n    marginTop() {\n      const devices = new RegExp('Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini', \"i\");\n      if (devices.test(navigator.userAgent)) {\n        return '100px'\n      } else {\n        return '40px'\n      }\n    },\n    getCookie(name) {\n      const value = `; ${document.cookie}`;\n      const parts = value.split(`; ${name}=`);\n      if (parts.length === 2) return parts.pop().split(';').shift();\n    }\n  }\n}\n</script>\n\n<style scoped>\n\n</style>"]}]}